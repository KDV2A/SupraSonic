<Page
    x:Class="SupraSonicWin.Pages.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <StackPanel Padding="40" Spacing="20">
        <TextBlock x:Name="TitleText" Text="Transcription Settings" FontSize="20" FontWeight="Bold"/>
        
        <StackPanel Spacing="10">
            <TextBlock x:Name="MicHeader" Text="Microphone Settings" FontWeight="SemiBold"/>
            <ComboBox x:Name="MicrophoneComboBox" Width="300" SelectionChanged="OnMicrophoneChanged">
                <ComboBoxItem Content="Default System Microphone" Tag="Default"/>
            </ComboBox>
            <Button x:Name="RefreshButton" Content="Refresh Devices" Click="OnRefreshDevicesClick" FontSize="12"/>
        </StackPanel>

        <StackPanel Spacing="10">
            <TextBlock x:Name="RecordingHeader" Text="Recording Mode" FontWeight="SemiBold"/>
            <RadioButton x:Name="PTTRadio" Content="Push to Talk (Hold Alt Gr)" Checked="OnHotkeyModeChanged" Tag="PTT"/>
            <RadioButton x:Name="ToggleRadio" Content="Toggle Mode (Click Alt Gr to start/stop)" Checked="OnHotkeyModeChanged" Tag="Toggle"/>
        </StackPanel>

        <StackPanel Spacing="10">
            <ToggleSwitch x:Name="HistoryToggle" Header="Enable History" Toggled="OnHistoryToggled"/>
            <ToggleSwitch x:Name="MuteToggle" Header="Mute system sound during recording" Toggled="OnMuteToggled"/>
            <ToggleSwitch x:Name="LaunchStartupToggle" Header="Launch at startup" Toggled="OnLaunchStartupToggled"/>
        </StackPanel>

        <StackPanel Spacing="10">
            <TextBlock x:Name="LLMHeader" Text="AI Model Provider" FontWeight="SemiBold"/>
            <ComboBox x:Name="LLMProviderComboBox" Width="300" SelectionChanged="OnLLMProviderChanged">
                <ComboBoxItem Content="Mistral (Local)" Tag="local"/>
                <ComboBoxItem Content="Gemini" Tag="gemini"/>
                <ComboBoxItem Content="ChatGPT (OpenAI)" Tag="openai"/>
                <ComboBoxItem Content="Claude (Anthropic)" Tag="anthropic"/>
            </ComboBox>
            <StackPanel x:Name="ApiKeyPanel" Spacing="5" Visibility="Collapsed">
                <TextBlock x:Name="ApiKeyHeader" Text="API Key" FontSize="12" Foreground="Gray"/>
                <StackPanel Orientation="Horizontal" Spacing="10">
                    <TextBox x:Name="ApiKeyBox" Width="300" TextChanged="OnApiKeyChanged"/>
                    <SymbolIcon x:Name="StatusIcon" Symbol="Accept" Foreground="Green" Visibility="Collapsed"/>
                </StackPanel>
                <TextBlock x:Name="ModelInfoText" FontSize="11" Foreground="Gray"/>
            </StackPanel>
            <TextBlock x:Name="LocalInfoText" Text="Using local Mistral model (offline)" FontSize="12" Foreground="Gray"/>
        </StackPanel>
        
        <StackPanel Spacing="10">
            <TextBlock x:Name="HotkeyHeader" Text="Global Hotkey" FontWeight="SemiBold"/>
            <StackPanel Orientation="Horizontal" Spacing="10">
                <Button x:Name="RecordHotkeyButton" Content="Record New Hotkey" Click="OnRecordHotkeyClick"/>
                <TextBlock x:Name="CurrentHotkeyLabel" Text="Alt Gr" VerticalAlignment="Center" Foreground="Gray"/>
            </StackPanel>
        </StackPanel>

        <StackPanel Spacing="10">
            <TextBlock x:Name="AIHotkeyHeader" Text="AI Assistant Hotkey" FontWeight="SemiBold"/>
            <StackPanel Orientation="Horizontal" Spacing="10">
                <Button x:Name="RecordAIHotkeyButton" Content="Record New Hotkey" Click="OnRecordAIHotkeyClick"/>
                <TextBlock x:Name="CurrentAIHotkeyLabel" Text="Right Ctrl" VerticalAlignment="Center" Foreground="Gray"/>
            </StackPanel>
        </StackPanel>

        <StackPanel Spacing="10">
            <TextBlock x:Name="AIPromptHeader" Text="AI Assistant Prompt" FontWeight="SemiBold"/>
            <TextBox x:Name="AIPromptBox" AcceptsReturn="True" TextWrapping="Wrap" MinHeight="100" Width="400" HorizontalAlignment="Left" TextChanged="OnAIPromptChanged"/>
            <TextBlock x:Name="AIPromptDesc" Text="Define how the AI transforms your text." FontSize="12" Foreground="Gray"/>
        </StackPanel>

        <StackPanel Spacing="10">
            <TextBlock x:Name="VocabularyHeader" Text="Vocabulary" FontWeight="SemiBold"/>
            <TextBlock x:Name="VocabularyDesc" Text="Teach SupraSonic how to spell specific words." FontSize="12" Foreground="Gray" TextWrapping="Wrap"/>
            <ListView x:Name="VocabularyListView" SelectionMode="None">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal" Spacing="10" Margin="0,5">
                            <TextBox Text="{Binding Spoken, Mode=TwoWay}" Width="150" PlaceholderText="Spoken"/>
                            <TextBox Text="{Binding Corrected, Mode=TwoWay}" Width="150" PlaceholderText="Correction"/>
                            <Button Content="î„ˆ" FontFamily="Segoe MDL2 Assets" Click="OnDeleteWordClick" CommandParameter="{Binding}"/>
                        </StackPanel>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
            <Button x:Name="AddWordButton" Content="Add Word" Click="OnAddWordClick"/>
        </StackPanel>
    </StackPanel>
</Page>
